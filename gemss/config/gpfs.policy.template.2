/* placement rule */
RULE 'DEFAULT' SET POOL 'system'


/* define external tape pools */
RULE EXTERNAL POOL 'TAPE MIGRATION CMS_DATA_RAW'
   EXEC '/var/mmfs/etc/hsmControl' OPTS 'CmsData gpfs_tsm'
RULE EXTERNAL POOL 'TAPE MIGRATION CMS_DATA_RECO'
   EXEC '/var/mmfs/etc/hsmControl' OPTS 'CmsData gpfs_tsm'
RULE EXTERNAL POOL 'TAPE MIGRATION CMS_MC'
   EXEC '/var/mmfs/etc/hsmControl' OPTS 'CmsMc gpfs_tsm'

/* Exclude from migration hidden directories (e.g. .SpaceMan), baby files, hidden and weird files. */
RULE 'exclude hidden directories' EXCLUDE WHERE PATH_NAME LIKE '%/.%'
RULE 'exclude hidden file' EXCLUDE WHERE NAME LIKE '.%'
RULE 'exclude empty files' EXCLUDE WHERE FILE_SIZE=0
RULE 'exclude baby files' EXCLUDE
   WHERE (CURRENT_TIMESTAMP-MODIFICATION_TIME)<INTERVAL '3' MINUTE

/* Define migrate rules to external pools */
RULE 'migrate from system to tape cms data raw' 
   MIGRATE FROM POOL 'system' THRESHOLD(0,80,0)
   WEIGHT(CURRENT_TIMESTAMP-ACCESS_TIME) 
   TO POOL 'TAPE MIGRATION CMS_DATA_RAW'
   FOR FILESET('CmsData') WHERE
     PATH_NAME LIKE '%/RAW/%' OR
     NAME LIKE '%.dat' OR
     PATH_NAME LIKE '%/RAW-RECO/%'

RULE 'migrate from system to tape cms data reco' 
   MIGRATE FROM POOL 'system' THRESHOLD(0,80,0)
   WEIGHT(CURRENT_TIMESTAMP-ACCESS_TIME) 
   TO POOL 'TAPE MIGRATION CMS_DATA_RECO'
   FOR FILESET('CmsData') WHERE
     PATH_NAME LIKE '%/RECO/%' OR
     PATH_NAME LIKE '%/ALCARECO/%'

RULE 'migrate from system to tape cms mc' 
   MIGRATE FROM POOL 'system' THRESHOLD(0,80,0)
   WEIGHT(CURRENT_TIMESTAMP-ACCESS_TIME) 
   TO POOL 'TAPE MIGRATION CMS_MC'
   FOR FILESET('CmsMc') WHERE
     PATH_NAME LIKE '%/Summer08/%' OR
     PATH_NAME LIKE '%/Summer09/%' OR
     PATH_NAME LIKE '%/Fall08/%' OR
     PATH_NAME LIKE '%/Winter09/%'
